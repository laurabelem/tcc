<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Terrário - Monitoramento</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <h1>Terrário - Monitoramento Ambiental</h1>

  <!-- Valores atuais -->
  <section class="card grid">
    <div class="info">
      <span class="label">Temperatura</span>
      <span id="tempAtual" class="value">-- °C</span>
    </div>

    <div class="info">
      <span class="label">Umidade</span>
      <span id="umidAtual" class="value">-- %</span>
    </div>

    <div class="info">
      <span class="label">Lâmpada</span>
      <span id="estadoLampada" class="value">--</span>
    </div>

    <div class="info">
      <span class="label">Setpoint</span>
      <span id="setpointAtual" class="value">-- °C</span>
    </div>
  </section>

  <!-- Ajuste do setpoint -->
  <section class="card">
    <h2>Ajuste do Setpoint</h2>

    <form id="formSetpoint">
      <div class="row">
        <input type="number" id="valorSetpoint" name="valor" step="0.1" required>
        <button type="submit">Aplicar</button>
      </div>
      <p class="note">O valor é salvo no ESP32 e permanece após reiniciar.</p>
    </form>
  </section>

  <!-- Conexão com a internet -->
  <section class="card">
    <h2>Conexão com a Internet</h2>

    <div class="net-status">
      <div><span class="label">Status:</span> <span id="netStatus">Desconectado</span></div>
      <div><span class="label">Hora atual:</span> <span id="netTime">Offline</span></div>
      <div><span class="label">Rede STA:</span> <span id="netSsid">Não configurado</span></div>
    </div>

    <div class="net-actions">
      <button type="button" id="syncNtpBtn">Sincronizar agora</button>
    </div>

    <form id="wifiForm">
      <div class="row">
        <input type="text" id="wifiSsid" name="ssid" placeholder="SSID da sua rede" required>
        <input type="password" id="wifiPass" name="senha" placeholder="Senha" required>
        <button type="submit">Salvar e conectar</button>
      </div>
      <p class="note">
        O ESP32 continua criando a rede <strong>TerrarioESP</strong> mesmo conectado ao Wi-Fi da casa.
      </p>
    </form>
  </section>

  <!-- Gráfico -->
  <section class="card">
    <h2>Linha do tempo de hoje</h2>
    <p class="note">Os pontos são registrados minuto a minuto com base na hora atual.</p>

    <div class="legend">
      <span class="dot temp"></span><span>Temperatura (°C)</span>
      <span class="dot umid"></span><span>Umidade (%)</span>
    </div>

    <div class="chart-container">
      <svg id="grafico" viewBox="0 0 100 70" preserveAspectRatio="none">

        <!-- Eixos -->
        <line x1="7" y1="65" x2="97" y2="65" class="axis"></line>
        <line x1="7" y1="5" x2="7" y2="65" class="axis"></line>

        <!-- Linhas das séries -->
        <polyline id="linhaTemp" class="line-temp"></polyline>
        <polyline id="linhaUmid" class="line-umid"></polyline>

        <!-- Pontos -->
        <g id="pontosTemp"></g>
        <g id="pontosUmid"></g>

        <!-- Rótulos -->
        <text x="50" y="69" class="axis-text">Tempo (min)</text>
        <text x="9" y="8" class="axis-text">Valor</text>
      </svg>
    </div>
  </section>

  <!-- Tabela -->
  <section class="card">
    <h2>Tabela de dados de hoje</h2>

    <table id="tabela">
      <thead>
        <tr>
          <th>Data</th>
          <th>Hora</th>
          <th>Temperatura (°C)</th>
          <th>Umidade (%)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <p class="note">
      CSV:
      <a href="/download?dia=0">dia 0</a> |
      <a href="/download?dia=1">dia 1</a> |
      <a href="/download?dia=2">dia 2</a> |
      <a href="/download?dia=3">dia 3</a> |
      <a href="/download?dia=4">dia 4</a> |
      <a href="/download?dia=5">dia 5</a> |
      <a href="/download?dia=6">dia 6</a>
    </p>
  </section>

  <script src="script.js"></script>
</body>
</html>
